{"is_source_file": true, "format": "TypeScript", "description": "This file defines a service module for gathering various statistics related to user activity and sessions, including high-level dashboard metrics, time series data, and breakdowns by device, location, etc., using MongoDB queries via Mongoose models.", "external_files": ["../models/ActivityEvent.js", "../models/Session.js"], "external_methods": ["Session.countDocuments", "ActivityEvent.countDocuments", "ActivityEvent.distinct", "ActivityEvent.aggregate"], "published": ["overviewStats", "timeseriesStats", "deviceBreakdown", "locationBreakdown"], "classes": [], "methods": [{"name": "export async function overviewStats(sinceMinutes = 60) { overviewStats", "description": "Returns high-level counts for dashboard visualization including active sessions, event count, and unique users since a specified interval.", "scope": "", "scopeKind": ""}, {"name": "export async function timeseriesStats(intervalMinutes = 5, totalMinutes = 60) { timeseriesStats", "description": "Provides time series count data over specified intervals for activity events.", "scope": "", "scopeKind": ""}, {"name": "export async function deviceBreakdown(sinceMinutes = 60) { deviceBreakdown", "description": "Generates a breakdown of activity events by device type and browser within a specified timeframe.", "scope": "", "scopeKind": ""}, {"name": "export async function locationBreakdown(sinceMinutes = 60) { locationBreakdown", "description": "Provides a breakdown of activity events by country within a specified timeframe.", "scope": "", "scopeKind": ""}], "calls": ["Session.countDocuments", "ActivityEvent.countDocuments", "ActivityEvent.distinct", "ActivityEvent.aggregate"], "search-terms": ["statsService", "activityEvent", "sessionAggregate", "deviceBreakdown", "locationBreakdown", "timeseries", "dashboardMetrics"], "state": 2, "file_id": 27, "knowledge_revision": 59, "git_revision": "", "ctags": [{"_type": "tag", "name": "$group", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^      $group: {$/", "language": "TypeScript", "kind": "constant", "scope": "deviceBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "$group", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^      $group: {$/", "language": "TypeScript", "kind": "constant", "scope": "timeseriesStats", "scopeKind": "function"}, {"_type": "tag", "name": "$group", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^    { $group: { _id: '$location.country', count: { $sum: 1 } } },$/", "language": "TypeScript", "kind": "constant", "scope": "locationBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "activeSessions", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const [activeSessions, eventsCount, uniqueUsers] = await Promise.all([$/", "language": "TypeScript", "kind": "constant", "scope": "overviewStats", "scopeKind": "function"}, {"_type": "tag", "name": "deviceBreakdown", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^export async function deviceBreakdown(sinceMinutes = 60) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "eventsCount", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const [activeSessions, eventsCount, uniqueUsers] = await Promise.all([$/", "language": "TypeScript", "kind": "constant", "scope": "overviewStats", "scopeKind": "function"}, {"_type": "tag", "name": "locationBreakdown", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^export async function locationBreakdown(sinceMinutes = 60) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "overviewStats", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^export async function overviewStats(sinceMinutes = 60) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "pipeline", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const pipeline = [$/", "language": "TypeScript", "kind": "constant", "scope": "deviceBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "pipeline", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const pipeline = [$/", "language": "TypeScript", "kind": "constant", "scope": "locationBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "pipeline", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const pipeline = [$/", "language": "TypeScript", "kind": "constant", "scope": "timeseriesStats", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const rows = await ActivityEvent.aggregate(pipeline);$/", "language": "TypeScript", "kind": "constant", "scope": "deviceBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const rows = await ActivityEvent.aggregate(pipeline);$/", "language": "TypeScript", "kind": "constant", "scope": "locationBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const rows = await ActivityEvent.aggregate(pipeline);$/", "language": "TypeScript", "kind": "constant", "scope": "timeseriesStats", "scopeKind": "function"}, {"_type": "tag", "name": "since", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const since = new Date(Date.now() - sinceMinutes * 60 * 1000);$/", "language": "TypeScript", "kind": "constant", "scope": "deviceBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "since", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const since = new Date(Date.now() - sinceMinutes * 60 * 1000);$/", "language": "TypeScript", "kind": "constant", "scope": "locationBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "since", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const since = new Date(Date.now() - sinceMinutes * 60 * 1000);$/", "language": "TypeScript", "kind": "constant", "scope": "overviewStats", "scopeKind": "function"}, {"_type": "tag", "name": "since", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const since = new Date(Date.now() - totalMinutes * 60 * 1000);$/", "language": "TypeScript", "kind": "constant", "scope": "timeseriesStats", "scopeKind": "function"}, {"_type": "tag", "name": "timeseriesStats", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^export async function timeseriesStats(intervalMinutes = 5, totalMinutes = 60) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "uniqueUsers", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const [activeSessions, eventsCount, uniqueUsers] = await Promise.all([$/", "language": "TypeScript", "kind": "constant", "scope": "overviewStats", "scopeKind": "function"}], "hash": "bedaea7d1976581aaa0ed2ffb6f4669f", "format-version": 4, "code-base-name": "frontend_dashboard", "filename": "backend_api/src/services/statsService.ts", "revision_history": [{"59": ""}]}