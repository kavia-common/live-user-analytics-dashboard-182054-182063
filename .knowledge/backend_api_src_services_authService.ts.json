{"is_source_file": true, "format": "TypeScript", "description": "This file implements authentication-related services such as token generation, user signup, login, and user data sanitization for a web application. It interacts with user models, handles JSON Web Tokens (JWT), and utilizes utility functions for debugging.", "external_files": ["../config/env.js", "../models/User.js", "../utils/debug.js"], "external_methods": ["getEnv", "User.findOne", "createUserWithPassword", "user.comparePassword", "user.save"], "published": ["generateToken", "signup", "login", "sanitizeUser"], "classes": [], "methods": [{"name": "export function generateToken(user: IUser): string { generateToken", "description": "Generates a JWT token for a given user with a 12-hour expiry, signing it with a secret from environment variables.", "scope": "", "scopeKind": ""}, {"name": "export async function signup(params: { email: string; password: string; name?: string; role?: 'a/ signup", "description": "Registers a new user if the email isn't already in use, creating the user and returning a token along with sanitized user data.", "scope": "", "scopeKind": ""}, {"name": "export async function login(params: { email: string; password: string }) { login", "description": "Authenticates a user with email and password, and if successful, updates last login timestamp, generates a token, and returns it with sanitized user info.", "scope": "", "scopeKind": ""}, {"name": "export function sanitizeUser(user: IUser) { sanitizeUser", "description": "Removes sensitive fields from the user object to prepare it for safe external use.", "scope": "", "scopeKind": ""}], "calls": ["jwt.sign", "getEnv", "User.findOne", "createUserWithPassword", "user.comparePassword", "user.save"], "search-terms": ["JWT token signing", "user signup", "user login", "token generation service", "auth service"], "state": 2, "file_id": 24, "knowledge_revision": 119, "git_revision": "6241b6678d4ba4937d8c14a0c734b886660ccbf2", "revision_history": [{"51": ""}, {"119": "6241b6678d4ba4937d8c14a0c734b886660ccbf2"}], "ctags": [{"_type": "tag", "name": "JWT_SECRET", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^  const { JWT_SECRET } = getEnv();$/", "language": "TypeScript", "kind": "constant", "scope": "generateToken", "scopeKind": "function"}, {"_type": "tag", "name": "err", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^    const err: any = new Error('Email already in use');$/", "language": "TypeScript", "kind": "constant", "scope": "signup", "scopeKind": "function"}, {"_type": "tag", "name": "err", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^    const err: any = new Error('Invalid email or password');$/", "language": "TypeScript", "kind": "constant", "scope": "login", "scopeKind": "function"}, {"_type": "tag", "name": "existing", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^  const existing = await User.findOne({ email: params.email });$/", "language": "TypeScript", "kind": "constant", "scope": "signup", "scopeKind": "function"}, {"_type": "tag", "name": "generateToken", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^export function generateToken(user: IUser): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^export async function login(params: { email: string; password: string }) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "payload", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^  const payload = {$/", "language": "TypeScript", "kind": "constant", "scope": "generateToken", "scopeKind": "function"}, {"_type": "tag", "name": "sanitizeUser", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^export function sanitizeUser(user: IUser) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "signup", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^export async function signup(params: { email: string; password: string; name?: string; role?: 'a/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^  const token = generateToken(user);$/", "language": "TypeScript", "kind": "constant", "scope": "login", "scopeKind": "function"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^  const token = generateToken(user);$/", "language": "TypeScript", "kind": "constant", "scope": "signup", "scopeKind": "function"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^  const token = jwt.sign(payload, JWT_SECRET, { expiresIn: '12h' });$/", "language": "TypeScript", "kind": "constant", "scope": "generateToken", "scopeKind": "function"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^  const user = await User.findOne({ email: params.email });$/", "language": "TypeScript", "kind": "constant", "scope": "login", "scopeKind": "function"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/backend_api/src/services/authService.ts", "pattern": "/^  const user = await createUserWithPassword(User, params);$/", "language": "TypeScript", "kind": "constant", "scope": "signup", "scopeKind": "function"}], "hash": "a9a22c424d257eb4d5e364e619e62801", "format-version": 4, "code-base-name": "frontend_dashboard", "filename": "backend_api/src/services/authService.ts"}