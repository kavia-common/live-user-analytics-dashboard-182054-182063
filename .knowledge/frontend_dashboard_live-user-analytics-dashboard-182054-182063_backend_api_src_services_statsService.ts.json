{"is_source_file": true, "format": "TypeScript", "description": "This file defines a stats service for a backend API, providing high-level dashboard statistics such as overview counts, timeseries data, device breakdown, and location breakdown by querying MongoDB via Mongoose models.", "external_files": ["../models/ActivityEvent.js", "../models/Session.js"], "external_methods": ["Session.countDocuments", "ActivityEvent.countDocuments", "ActivityEvent.distinct", "ActivityEvent.aggregate"], "published": ["overviewStats", "timeseriesStats", "deviceBreakdown", "locationBreakdown"], "classes": [], "methods": [{"name": "export async function overviewStats(sinceMinutes = 60) { overviewStats", "description": "Returns high-level counts for active sessions, activity events, and unique users within a specified recent time window.", "scope": "", "scopeKind": ""}, {"name": "export async function timeseriesStats(intervalMinutes = 5, totalMinutes = 60) { timeseriesStats", "description": "Returns per-interval counts over a total period, aggregating activity events into timestamps based on the specified interval.", "scope": "", "scopeKind": ""}, {"name": "export async function deviceBreakdown(sinceMinutes = 60) { deviceBreakdown", "description": "Aggregates activity events by device type and browser within a recent time window.", "scope": "", "scopeKind": ""}, {"name": "export async function locationBreakdown(sinceMinutes = 60) { locationBreakdown", "description": "Aggregates activity events by country within a recent time window.", "scope": "", "scopeKind": ""}], "calls": ["Session.countDocuments", "ActivityEvent.countDocuments", "ActivityEvent.distinct", "ActivityEvent.aggregate"], "search-terms": ["statsService", "overviewStats", "timeseriesStats", "deviceBreakdown", "locationBreakdown", "ActivityEvent.aggregate", "MongoDB aggregation pipeline", "dashboard statistics", "activity events", "session counts"], "state": 2, "file_id": 95, "knowledge_revision": 316, "git_revision": "", "ctags": [{"_type": "tag", "name": "$group", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^      $group: {$/", "language": "TypeScript", "kind": "constant", "scope": "deviceBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "$group", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^      $group: {$/", "language": "TypeScript", "kind": "constant", "scope": "timeseriesStats", "scopeKind": "function"}, {"_type": "tag", "name": "$group", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^    { $group: { _id: '$location.country', count: { $sum: 1 } } },$/", "language": "TypeScript", "kind": "constant", "scope": "locationBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "activeSessions", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const [activeSessions, eventsCount, uniqueUsers] = await Promise.all([$/", "language": "TypeScript", "kind": "constant", "scope": "overviewStats", "scopeKind": "function"}, {"_type": "tag", "name": "deviceBreakdown", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^export async function deviceBreakdown(sinceMinutes = 60) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "eventsCount", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const [activeSessions, eventsCount, uniqueUsers] = await Promise.all([$/", "language": "TypeScript", "kind": "constant", "scope": "overviewStats", "scopeKind": "function"}, {"_type": "tag", "name": "locationBreakdown", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^export async function locationBreakdown(sinceMinutes = 60) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "overviewStats", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^export async function overviewStats(sinceMinutes = 60) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "pipeline", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const pipeline: any[] = [$/", "language": "TypeScript", "kind": "constant", "scope": "deviceBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "pipeline", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const pipeline: any[] = [$/", "language": "TypeScript", "kind": "constant", "scope": "locationBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "pipeline", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const pipeline: any[] = [$/", "language": "TypeScript", "kind": "constant", "scope": "timeseriesStats", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const rows = await ActivityEvent.aggregate(pipeline);$/", "language": "TypeScript", "kind": "constant", "scope": "deviceBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const rows = await ActivityEvent.aggregate(pipeline);$/", "language": "TypeScript", "kind": "constant", "scope": "locationBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const rows = await ActivityEvent.aggregate(pipeline);$/", "language": "TypeScript", "kind": "constant", "scope": "timeseriesStats", "scopeKind": "function"}, {"_type": "tag", "name": "since", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const since = new Date(Date.now() - sinceMinutes * 60 * 1000);$/", "language": "TypeScript", "kind": "constant", "scope": "deviceBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "since", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const since = new Date(Date.now() - sinceMinutes * 60 * 1000);$/", "language": "TypeScript", "kind": "constant", "scope": "locationBreakdown", "scopeKind": "function"}, {"_type": "tag", "name": "since", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const since = new Date(Date.now() - sinceMinutes * 60 * 1000);$/", "language": "TypeScript", "kind": "constant", "scope": "overviewStats", "scopeKind": "function"}, {"_type": "tag", "name": "since", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const since = new Date(Date.now() - totalMinutes * 60 * 1000);$/", "language": "TypeScript", "kind": "constant", "scope": "timeseriesStats", "scopeKind": "function"}, {"_type": "tag", "name": "timeseriesStats", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^export async function timeseriesStats(intervalMinutes = 5, totalMinutes = 60) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "uniqueUsers", "path": "/home/kavia/workspace/code-generation/live-user-analytics-dashboard-182054-182063/frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "pattern": "/^  const [activeSessions, eventsCount, uniqueUsers] = await Promise.all([$/", "language": "TypeScript", "kind": "constant", "scope": "overviewStats", "scopeKind": "function"}], "hash": "492fca92ebec53ef5050822b182536a6", "format-version": 4, "code-base-name": "frontend_dashboard", "filename": "frontend_dashboard/live-user-analytics-dashboard-182054-182063/backend_api/src/services/statsService.ts", "revision_history": [{"316": ""}]}